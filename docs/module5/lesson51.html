<!DOCTYPE html>
<html lang="en">
<head>
	<title>Lesson 5.1: Tracking Mouse Movement</title>
	<link rel="stylesheet" media="screen" href="../css/style.css">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Thomas S. Phillips">
	<meta name="robots" content="noindex, nofollow">
	<script src="../scripts/google-code-prettify/run_prettify.js"></script>
</head>
<body><div id="container">

    <header>Learning objective 5.1: Write code that tracks the mouse position on the screen.</header>
    
    <div id="banner">
        <div id="support">
            <b>CONTACT</b><br>The original author can be reached at &#116;&#111;&#109;&#064;&#116;&#115;&#112;&#104;&#105;&#108;&#108;&#105;&#112;&#115;&#046;&#110;&#101;&#116;.<br>
            <br>
            <br>
            <br>
        </div>
    </div>
    
    <div id="content-container">

    <nav class="ac-container">
        <div>
            <input id="ac-0" name="accordion-1" type="radio" />
            <label for="ac-0" class="examplelabel">Final Game</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../game/game.html" target="_blank">The Final Game</a></li>
                    <li><a href="../game/game.js" target="_blank">Game Source Code</a></li>
                </ul>
            </article>
        </div>

        <div>
            <input id="ac-1" name="accordion-1" type="radio" />
            <label for="ac-1">1: Getting Started</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module1/index.html">Module 1 Overview</a></li>
                    <li>1.1 <a href="../module1/lesson11.html">Introduction</a></li>
                    <li>1.2 <a href="../module1/lesson12.html">Basic Tools</a></li>
                    <li>1.3 <a href="../module1/lesson13.html">The Core Game</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-2" name="accordion-1" type="radio" />
            <label for="ac-2">2: Game Design</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module2/index.html">Module 2 Overview</a></li>
                    <li>2.1 <a href="../module2/lesson21.html">Match-3 Games</a></li>
                    <li>2.2 <a href="../module2/lesson22.html">Adapting the Game</a></li>
                    <li>2.3 <a href="../module2/lesson23.html">Game Design</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-3" name="accordion-1" type="radio" />
            <label for="ac-3">3: Data</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module3/index.html">Module 3 Overview</a></li>
                    <li>3.1 <a href="../module3/lesson31.html">Game Variables</a></li>
                    <li>3.2 <a href="../module3/lesson32.html">Input and Output</a></li>
                    <li>3.3 <a href="../module3/lesson33.html">Game State</a></li>
                    <li>3.4 <a href="../module3/lesson34.html">Game Board</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-4" name="accordion-1" type="radio" />
            <label for="ac-4">4: Display</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module4/index.html">Module 4 Overview</a></li>
                    <li>4.1 <a href="../module4/lesson41.html">Loading Images</a></li>
                    <li>4.2 <a href="../module4/lesson42.html">Drawing in Layers</a></li>
                    <li>4.3 <a href="../module4/lesson43.html">Background and Framing</a></li>
                    <li>4.4 <a href="../module4/lesson44.html">Draw a Grid of Tiles</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-5" name="accordion-1" type="radio" checked />
            <label for="ac-5">5: Input</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module5/index.html">Module 5 Overview</a></li>
                    <li><b>5.1 <a href="../module5/lesson51.html">Tracking Mouse Movement</a></b></li>
                    <li>5.2 <a href="../module5/lesson52.html">Clicking Tiles</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-6" name="accordion-1" type="radio" />
            <label for="ac-6">6: Rules of the Game</label>
            <article class="ac-medium">
                <ul>
                    <li><a href="../module6/index.html">Module 6 Overview</a></li>
                    <li>6.1 <a href="../module6/lesson61.html">Main Rules</a></li>
                    <li>6.2 <a href="../module6/lesson62.html">Replacing Tiles</a></li>
                    <li>6.3 <a href="../module6/lesson63.html">Falling Tiles</a></li>
                    <li>6.4 <a href="../module6/lesson64.html">Clear 3-in-a-Row</a></li>
                    <li>6.5 <a href="../module6/lesson65.html">Swapping Tiles</a></li>
                    <li>6.6 <a href="../module6/lesson66.html">Game Over?</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-7" name="accordion-1" type="radio" />
            <label for="ac-7">7: Visual Effects</label>
            <article class="ac-medium">
                <ul>
                    <li><a href="../module7/index.html">Module 7 Overview</a></li>
                    <li>7.1 <a href="../module7/lesson71.html">Loading Visual Effects</a></li>
                    <li>7.2 <a href="../module7/lesson72.html">Selection Effect</a></li>
                    <li>7.3 <a href="../module7/lesson73.html">Smooth Dropping Tiles</a></li>
                    <li>7.4 <a href="../module7/lesson74.html">What's the score?</a></li>
                    <li>7.5 <a href="../module7/lesson75.html">Just the Facts</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-8" name="accordion-1" type="radio" />
            <label for="ac-8">8: Sound Effects</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module8/index.html">Module 8 Overview</a></li>
                    <li>8.1 <a href="../module8/lesson81.html">Detect Supported Audio</a></li>
                    <li>8.2 <a href="../module8/lesson82.html">Load Audio</a></li>
                    <li>8.3 <a href="../module8/lesson83.html">Play Triggered Audio</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-9" name="accordion-1" type="radio" />
            <label for="ac-9">9: Going Forward</label>
            <article class="ac-small">
                <ul>
                    <li><a href="../module9/index.html">Module 9 Overview</a></li>
                    <li>9.1 <a href="../module9/lesson91.html">Customization</a></li>
                    <li>9.2 <a href="../module9/lesson92.html">Extending the Game</a></li>
                    <li>9.3 <a href="../module9/lesson93.html">Conclusion</a></li>
                </ul>
            </article>
        </div>
        <div>
            <input id="ac-10" name="accordion-1" type="radio" />
            <label for="ac-10" class="examplelabel">Examples</label>
            <article class="ac-large">
                <ul>
                    <li>(all open in new window)</li>
                    <li><a href="../examples/example13.html" target="_blank">1.3 Blink</a></li>
                                
                    <li><a href="../examples/example31.html" target="_blank">3.1 Drawing Offsets</a></li>
                    <li><a href="../examples/example32.html" target="_blank">3.2 Canvas and Context</a></li>
                    <li><a href="../examples/example33.html" target="_blank">3.3 Game States</a></li>
                    <li><a href="../examples/example34.html" target="_blank">3.4 Arrays</a></li>
            
                    <li><a href="../examples/example41.html" target="_blank">4.1 Loading Images</a></li>
                    <li><a href="../examples/example42.html" target="_blank">4.2 Drawing Layers</a></li>
                    <li><a href="../examples/example43.html" target="_blank">4.3 Image Position</a></li>
                    <li><a href="../examples/example44.html" target="_blank">4.4 Drawing Grids</a></li>
            
                    <li><a href="../examples/example51.html" target="_blank">5.1 The Mouse</a></li>
                    <li><a href="../examples/example52.html" target="_blank">5.2 Mouse Click</a></li>
            
                    <li><a href="../examples/example61.html" target="_blank">6.1 Toggle Tiles</a></li>
                    <li><a href="../examples/example62.html" target="_blank">6.2 Simple Game</a></li>
                    <li><a href="../examples/example63.html" target="_blank">6.3 Falling Tiles</a></li>
                    <li><a href="../examples/example64.html" target="_blank">6.4 Bonus Match</a></li>
                    <li><a href="../examples/example65.html" target="_blank">6.5 Moving Earth</a></li>
                    <li><a href="../examples/example66.html" target="_blank">6.6 Martian Orbit</a></li>
                    
                    <li><a href="../examples/example71.html" target="_blank">7.1 Flashy</a></li>
                    <li><a href="../examples/example72.html" target="_blank">7.2 Pulse</a></li>
                    <li><a href="../examples/example73.html" target="_blank">7.3 Pulsing Earth</a></li>
                    <li><a href="../examples/example74.html" target="_blank">7.4 Clickity-Clack</a></li>
                    <li><a href="../examples/example75.html" target="_blank">7.5 Rainbow Text</a></li>
                    
                    <li><a href="../examples/example81.html" target="_blank">8.1 Environment</a></li>
                    <li><a href="../examples/example82.html" target="_blank">8.2 Sounds</a></li>
                    <li><a href="../examples/example83.html" target="_blank">8.3 Volume</a></li>
                </ul>
            </article>
        </div>

    </nav>
    
    <section id="content">
        &nbsp;
        <h2>Lesson 5.1: Tracking Mouse Movement</h2>
        
        <div class="video">
            <video controls>
                <source src="video51.mp4" type="video/mp4">
                <source src="video51.ogg" type="video/ogg">
                Your browser does not support the video tag.
            </video>
        </div>

<img class="sidebar" src="animation5_1.gif">

<p>Getting input for a game is very different from drawing on the screen and can be tricky. When we are drawing we decide what we want to draw, where we want to draw, and when to draw it. Input from a player can be crazy. A player can mash all the keys at once, swing the mouse over their head, and generally make our life difficult trying to figure out what the player wants to do.</p>

<p>Our match-3 game will only look at what the mouse is doing; there is no keyboard input. For the mouse we want to know where it is pointing and when the player is clicking. This lesson focuses on where the mouse is pointing.</p>

<p>First, keep in mind the mouse can move at any time. What we need is a way for the computer to tell us whenever the mouse has moved. To do that we will create a function, and then tell the web browser to call that function any time the mouse moves.</p>

<p>Here's the basic way to tell the browser we are interested in mouse movement:</p>

<pre class="prettyprint lang-javascript" style="font-size:10pt;">
canvas.onmousemove = function(event) {
  // Do something interesting here.
}
</pre>

<p>Our function will be called every time the mouse moves across the canvas. Our function does not need a name because we never call it -- we are telling the computer what to do when it encounters a specific situation.</p>

<aside><b>Look! Another object...</b><br>Just like "context" is an object, "event" is also an object. However, we are interested in some of the variables that are attached to the "event" object. For example, "event.clientX" is the x position of the mouse.</aside>
<p>Every time our function is called, it will be called with an event variable. The event variable will tell us where the mouse is. For example, here's a code snippet to see how far to the right the mouse is:</p>

<p><code>
event.clientX
</code></p>

<p>Unfortunately, there's a snag. The event is going to tell us where the mouse is on the screen, but we need to know where it is over the canvas. We don't know much (or anything, really) about stuff not in our canvas. To figure out where the mouse is over the canvas, we use this code snippet:</p>

<pre class="prettyprint lang-javascript" style="font-size:10pt;">
mouse_x = event.clientX - canvas.offsetLeft;
mouse_y = event.clientY - canvas.offsetTop;
</pre>

<aside>Did you guess it? The "canvas" variable is really another object! We don't use many objects in the game -- canvas, context, and event are a few. They can be very useful, though. Objects (and classes) are used in object oriented programming and let us bundle up groups of functions and variables.</aside>
<p>Those other variables tell us where the canvas is on the screen. Keep in mind the canvas position on the screen can change all the time depending on how big the player makes the browser.</p>

<p>We're almost there -- there's just one more thing we need to figure out. The player will be pointing the mouse at specific tiles to do swaps. We need to know which tile the player is pointing at. To that end, here is the code to figure that out:</p>

<pre class="prettyprint lang-javascript" style="font-size:10pt;">
tile_x = Math.floor((mouse_x - grid_offset_x) / tile_width);
tile_y = Math.floor((mouse_y - grid_offset_y) / tile_height);
</pre>

<aside><b>Math</b><br>You may remember the "Math" functions from the random_tile() function. Although "Math" is technically an object, it really behaves like a class. It bundles up (i.e., encapsulates) many useful mathematical functions and constants.</aside>
<p>The new thing here is the <code>Math.floor()</code> function. The function will round a number down. For example, <code>Math.floor(3.7)</code> is equal to 3.</p>

<p>And here is the final code to track the mouse position:</p>

<pre class="prettyprint lang-javascript" style="font-size:10pt;">
//////////////////////////////////
// Lesson 5.1 Tracking Mouse Movement

canvas.onmousemove = function(event) {
   mouse_x = event.clientX - canvas.offsetLeft;
   mouse_y = event.clientY - canvas.offsetTop;
   tile_x = Math.floor((mouse_x - grid_offset_x) / tile_width);
   tile_y = Math.floor((mouse_y - grid_offset_y) / tile_height);
}; // onmousemove()
</pre>

<p>Now, any time the player moves the mouse around, the <code>tile_x</code> and <code>tile_y</code> variables will be kept up to date.</p>

        <a href="index.html"><img src="../media/previous_button.png" width="210" height="62" alt="Previous Lesson" style="float:left;margin:5px;" /></a>
        <a href="lesson52.html"><img src="../media/next_button.png" width="210" height="62" alt="Next Lesson" style="float:right;margin:5px;" /></a>
        
        <div style="height:62px;"></div>
        <p />
        
        <hr width="80%">
        <a href="../examples/example51.html" target="_blank"><img class="center" src="example5_1.png" /></a>

    </section>

    &nbsp;

    </div>

    <footer>
        <div class="trademark">Game Blueprint is a trademark of Thomas S. Phillips.</div>
        <div class="copyright">Copyright &copy; 2014 Thomas S. Phillips.</div>
    </footer>
</div></body>
</html>
